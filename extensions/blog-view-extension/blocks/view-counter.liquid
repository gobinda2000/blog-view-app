{{ 'article-app.css' | asset_url | stylesheet_tag }}
<div class="view-counter center" data-article-id="{{ article.id }}">
  <img src="{{ 'See.svg' | asset_url }}" alt="Views" width="24" height="24">
  <span>{{ article.metafields.custom.view_count }}</span>
</div>

<script src="{{ 'article-view-counter.js' | asset_url }}" defer></script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
  const viewDiv = document.querySelector(".view-counter");

  if (!viewDiv) {
    console.error("View counter element not found!");
    return;
  }

  // ✅ Use your ngrok/production backend URL
  const tracker = new ArticleViewTracker(
    "{{ block.settings.api_url }}",
    viewDiv
  );

  tracker.sendView();
});

</script>

{% schema %}
{
  "name": "Blog View Counter",
  "target": "section",
  "settings": [
    {
      "type": "text",
      "id": "api_url",
      "label": "t:settings_schema.global.settings.blog.view.label",
      "placeholder": "https://your-backend-endpoint.com"   // ✅ instead of autofill
    },
  ]
}
{% endschema %}
